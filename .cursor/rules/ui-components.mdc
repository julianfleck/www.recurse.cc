---
description: "UI Component Framework Guidelines - ReUI, Shadcn, and Custom Components"
globs: ["apps/**/components/**/*.{ts,tsx}", "packages/ui/**/*.{ts,tsx}"]
alwaysApply: true
lastVerified: 2025-10-31T02:50:00Z
sources:
  - name: "ReUI Documentation"
    url: "https://reui.io/docs/avatar"
    accessedAt: 2025-10-28T05:00:00Z
  - name: "Shadcn UI Documentation"
    url: "https://ui.shadcn.com"
    accessedAt: 2025-10-28T05:00:00Z
  - name: "Shadcn MCP Server"
    url: "https://ui.shadcn.com/docs/mcp"
    accessedAt: 2025-10-28T05:00:00Z
---

# UI Component Framework Guidelines

## Priority Order

### 1. ReUI (Default) üé®
Elegant, production-ready components via the Shadcn registry. **Always check ReUI first.**

**When to use:**
- Adding new UI components (default choice)
- Wanting polished, styled components
- Need advanced variants (Avatar with indicators, badges, status)

**Installation:**

**Direct installation to packages/ui (Recommended):**
```bash
cd packages/ui
pnpm dlx shadcn@latest add @reui/<component-name> --yes

# Example: Add Avatar component
pnpm dlx shadcn@latest add @reui/avatar --yes
```

**‚ö†Ô∏è Important:** Do NOT use `--overwrite` flag unless you intentionally want to replace an existing custom component (like button). The `--overwrite` flag will replace our custom implementations.

**Fallback (if direct installation fails):**
```bash
# Install to app first, then copy
cd apps/www
pnpm dlx shadcn@latest add @reui/<component-name> --yes
# Then copy to packages/ui and update imports
```

**Usage:**
```tsx
import { Avatar, AvatarFallback, AvatarIndicator } from "@/components/ui/avatar";
```

**Official Registry:** https://reui.io

### 2. Shadcn (Fallback) üì¶
Standard Shadcn components when ReUI variant doesn't exist.

**When to use:**
- ReUI doesn't have the component
- ReUI doesn't have a suitable variant
- Need basic Radix UI wrapper

**Installation:**

**Direct installation to packages/ui (Recommended):**
```bash
cd packages/ui
pnpm dlx shadcn@latest add <component-name> --yes

# Example: Add Button component (if needed)
pnpm dlx shadcn@latest add button --yes
```

**‚ö†Ô∏è Important:** Do NOT use `--overwrite` flag unless you intentionally want to replace an existing custom component.

**Usage:**
```tsx
import { Button } from "@/components/ui/button";
```

**Official Registry:** https://ui.shadcn.com

### 3. Packages/UI (Shared) üîÑ
Monorepo-shared components from `packages/ui`.

**When to use:**
- Component already exists in `packages/ui`
- Need to share across multiple apps
- Avoiding duplication

**Usage:**
```tsx
// IN PACKAGES:
import { Button } from "@recurse/ui/components/button";

// IN APPS (only when packages/ui is fully set up):
import { Button } from "@recurse/ui";
```

**Current Status:** ‚ö†Ô∏è Under migration - prefer local imports for now.

## Using MCP Server for Component Installation

### Setup
The Shadcn MCP server is configured in `.cursor/mcp.json` and enables AI assistants to browse, search, and install components using natural language.

### MCP Capabilities
- **Browse Components** - List all available components from any configured registry
- **Search Across Registries** - Find specific components by name or functionality
- **Install with Natural Language** - Add components using conversational prompts
- **Support for Multiple Registries** - Access shadcn, ReUI, and custom registries

### Example Prompts

**Browse & Search:**
- "Show me all available components in the shadcn registry"
- "Find me a login form from the shadcn registry"
- "List all avatar variants in the ReUI registry"

**Install Components:**
- "Add the button, dialog and card components to my project"
- "Create a contact form using components from the shadcn registry"
- "Install the Avatar component with status indicator from ReUI"

**Work with Namespaces:**
- "Show me components from ReUI registry"
- "Install @reui/avatar-status"
- "Build me a landing page using hero, features and testimonials sections"

### Manual Installation

If MCP isn't available or you prefer CLI:

```bash
# ReUI (preferred)
pnpm dlx shadcn@latest add @reui/avatar

# Shadcn (fallback)
pnpm dlx shadcn@latest add avatar

# Specify target directory
pnpm dlx shadcn@latest add @reui/avatar --cwd apps/docs/components/ui
```

### Registry Configuration

Registries are configured in `components.json`:

```json
{
  "registries": {
    "@reui": "https://reui.io/{name}.json"
  }
}
```

All apps should have their own `components.json` with appropriate registries configured.

## Component Organization

### App-Level Components
```
apps/docs/components/ui/     # Local UI components
apps/docs/components/         # App-specific components
```

### Shared Components
```
packages/ui/src/components/   # Shared UI components
packages/ui/src/lib/         # Shared utilities (cn, etc.)
```

## Adding New Components

### Step 1: Check Existing Components
- Search `packages/ui/src/components/` for existing component
- Check app-level `components/ui/` directories
- Review component needs vs available options

### Step 2: Choose Framework
1. **ReUI (Default)** - Always check first (https://reui.io)
2. **Shadcn (Fallback)** - Only if ReUI doesn't have it
3. **Custom** - If neither framework fits needs

### Step 3: Install Using MCP or CLI

**Via MCP (Preferred):**
- Ask: "Add the avatar component from ReUI to packages/ui"
- AI will handle installation automatically

**Via CLI:**
```bash
# ReUI (preferred) - Install directly to packages/ui
cd packages/ui
pnpm dlx shadcn@latest add @reui/avatar --yes

# Shadcn (fallback) - Install directly to packages/ui
cd packages/ui
pnpm dlx shadcn@latest add avatar --yes

# ‚ö†Ô∏è Important: Do NOT use --overwrite unless replacing custom components
```

### Step 4: Fix Import Paths

After installation, check and fix import paths in the generated component:
```typescript
// shadcn may generate:
import { cn } from '@recurse/ui/lib/utils';

// Keep if utils.ts exists, or change to:
import { cn } from '@recurse/ui/lib';
```

### Step 5: Update Exports

Add to `packages/ui/src/components/index.ts`:
```typescript
export * from './<component-name>';
```

### Step 6: Import Pattern
```tsx
// ‚úÖ Use shared package (preferred)
import { Avatar } from "@recurse/ui/components";

// Or full path
import { Avatar } from "@recurse/ui/components/avatar";
```

## Component Guidelines

### Avatar Component (Example)

**ReUI Variants:**
- `@reui/avatar-default` - Basic avatar
- `@reui/avatar-fallback` - With fallback initials
- `@reui/avatar-indicator` - With status indicator
- `@reui/avatar-status` - With status badge
- `@reui/avatar-badge` - With badge overlay
- `@reui/avatar-group` - Multiple avatars

**Usage Pattern:**
```tsx
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";

<Avatar>
  <AvatarImage src="/user.jpg" alt="User" />
  <AvatarFallback>JD</AvatarFallback>
</Avatar>
```

## Migration Strategy

### Current State
- Apps use local imports from `@/components/ui/`
- Shared components exist in `packages/ui` but incomplete
- Mix of ReUI and Shadcn components

### Target State
- All apps import from `@recurse/ui`
- Consistent ReUI > Shadcn priority
- Shared utilities centralized

### Migration Steps
1. ‚úÖ Identify missing components in `packages/ui`
2. üîÑ Add ReUI components to `packages/ui`
3. üîÑ Update app imports to use `@recurse/ui`
4. üîÑ Remove duplicate app-level components
5. üîÑ Add documentation for each component

## Best Practices

1. **ReUI is default** - Always check ReUI first before falling back to Shadcn
2. **Install directly to packages/ui** - Use `cd packages/ui && pnpm dlx shadcn@latest add @reui/<name> --yes`
3. **Never use --overwrite** - Unless intentionally replacing a custom component
4. **Use MCP for installation** - Ask AI to install components naturally
5. **Use Shadcn CLI as fallback** - When MCP isn't available
6. **Use shared imports** - Import from `@recurse/ui/components` (not app-level)
7. **Fix import paths** - Check generated imports and update to match our structure
8. **Update exports** - Always add to `packages/ui/src/components/index.ts`
9. **Document custom variants** - Add props examples in component files

## Current Component Inventory

### In packages/ui
- avatar, badge, button, calendar, card, checkbox, collapsible, command
- copy-button, dialog, dropdown-menu, icon-toggle-button, input
- label, popover, progress-circle, radio-group, scroll-area, select
- spinner, switch, table, theme-toggle, toc, toc-clerk, toc-thumb, tooltip
- kibo-ui components (announcement, kbd, pill, status)

### In apps (local)
- All apps have their own `components/ui/` directories
- Some duplication exists (being migrated)

## Troubleshooting

### Import Errors
- Check component exists in target location
- Verify path alias (`@/` resolves correctly)
- Ensure workspace package is installed (`pnpm install`)

### Style Issues
- Verify Tailwind config includes component styles
- Check if component needs CSS import
- Review component source for required dependencies

### Framework Confusion
- **ReUI** = Better styled, more variants
- **Shadcn** = Standard, more control
- **Shared** = Reusable across apps

### MCP Not Working
- Restart Cursor after MCP configuration
- Check `.cursor/mcp.json` exists and is valid
- Verify `components.json` has registry configuration
- Run `/mcp` command in Cursor to debug

## References

- **ReUI:** https://reui.io
- **Shadcn:** https://ui.shadcn.com
- **MCP Server:** https://ui.shadcn.com/docs/mcp
- **Registry Config:** https://ui.shadcn.com/docs/registry

## Proposed Changes

- [ ] Complete migration to `@recurse/ui` imports
- [ ] Document all ReUI variants
- [ ] Create component showcase/migration guide
- [ ] Add TypeScript types for all components
- [ ] Set up automated component testing
