---
title: "Substack Blog Mirroring"
status: "completed"
owners:
  - "Julian"
  - "Agents"
completedAt: "2025-01-27"
---

## Goal

Mirror tagged Substack posts to `blog.recurse.cc` (and `/blog` inside the marketing app) using the existing www layout and the Fumadocs MDX pipeline so that every essay lives alongside the rest of the product surface.

## Constraints

- **Layout parity:** Pages must render inside the marketing shell (header, footer, hero typography) while the article body uses Fumadocs MDX components for consistency.
- **Single content source:** Blog entries live under `content/blog/**`, matching how the docs/dashboard content is organized.
- **Automation first:** New posts should arrive by running a deterministic script (and later, via CI/cron) that consumes the Substack RSS feed. No manual copy/paste.
- **Safety:** Avoid ingesting posts that are not ours—filter by tag list if needed and keep a local cache of processed GUIDs.

## Architecture

| Layer | Responsibility |
| --- | --- |
| `scripts/sync-substack-posts.ts` | Fetch RSS feed (`SUBSTACK_FEED_URL`), convert HTML → MDX, write `content/blog/<year>/<slug>.mdx`, update `meta.json`, persist cache |
| `packages/blog` | Wrap Fumadocs loader, expose `getAllBlogPosts`, `blogSource`, MDX components, and `BlogArticleLayout` |
| `apps/www/app/blog/**` | Listing page for featured posts + MDX-rendered article route (`[...slug]`) |
| `navigationContent.blog` | Pull most recent posts from a shared `@/lib/blog` helper (powered by `@recurse/blog`) for the header dropdown |

## Rollout Plan

1. ✅ Create `content/blog` tree with Meta definitions and Substack-synced articles (per-year folders + `meta.json` hierarchy).
2. ✅ Add `packages/blog` (Fumadocs loader factory, MDX components, article layout, helpers for listing + detail views).
3. ✅ Wire `/blog` listing + `/blog/[...slug]` detail pages in `apps/www` using `@recurse/blog` helpers so marketing renders live posts.
4. ✅ Update navigation menu (`navigationContent.blog`) to read the latest posts via `apps/www/lib/blog.ts`, falling back to placeholders when empty.
5. ✅ Implement RSS sync script (`scripts/sync-substack-posts.ts`) with workspace dependencies (`fast-xml-parser`, `turndown`, `gray-matter`) and cache file (`scripts/.substack-sync.json` ignored).
6. ⏭️ Add CI/Vercel cron target that runs `pnpm sync:blog` (future enhancement).
7. ⏭️ Expand docs + troubleshooting once automation is live (future enhancement).

### Completed Work Details

- **Content pipeline:** `pnpm sync:blog` fetches `https://j0lian.substack.com/feed`, converts HTML → MDX, writes files to `content/blog/<year>/<slug>.mdx`, and maintains both root and yearly `meta.json` files so Fumadocs navigation mirrors the structure.
- **Shared blog package:** `packages/blog` exports `createBlogHelpers`, `BlogArticleLayout`, and MDX components; marketing (and future apps) import these helpers via `@recurse/blog`.
- **Marketing integration:** `apps/www/lib/blog.ts` instantiates the helpers by importing the app-local `@/.source` bundle (generated by `fumadocs-mdx` postinstall). The `/blog` routes simply render listings/detail pages using those helpers. Navigation now hydrates from real data via `apps/www/content/navigation.ts`.
- **Docs & type fixes:** Docs build pulls metadata badges with a typed transformer in `apps/docs/lib/source.ts`, ensuring `pnpm --filter docs.recurse.cc build` passes.

## Next Phase: Dedicated Blog App

1. **Spin up `apps/blog`:** Create a standalone Next.js 15 App Router project that consumes `packages/blog` for MDX loading, so blog routes have an isolated build and deployment target (`blog.recurse.cc`). Keep Substack CDN media URLs as-is for now; the app only needs to proxy article HTML/MDX, not assets.
2. **Reuse marketing layout:** Export the existing `apps/www` shell (header, footer, typography primitives) into a sharable layout module so `apps/blog` renders articles with identical styling while still leveraging Fumadocs MDX rendering from `packages/blog`.
3. **Forward marketing routes:** Keep `/blog` and `/blog/[...slug]` under `apps/www`, but have those routes defer to the blog package/app (e.g., server components that call into `@recurse/blog` or proxy requests) so marketing stays the front door while `apps/blog` owns logic.
4. **Navigation + homepage data:** Centralize blog navigation data in `content/navigation.ts` (or a dedicated `navigation.ts`) so both apps read the same helpers without duplicate queries. Surface the six most recent posts in the navigation dropdown (`navigationContent.blog`) and reserve deeper archives for the blog index itself.
5. **Deployment + DX:** Ensure Turbopack/webpack aliases resolve `@/.source` inside both apps, add workspace scripts for `pnpm dev:blog`/`build:blog`, and verify `pnpm lint`/`pnpm build --filter ...` succeed across docs, www, and the new blog app.
6. **Sticky sidebar layout:** Mirror the FAQ page layout (sticky left rail, scrollable article pane on the right) in both the `/blog` listing and article detail routes. The sidebar should include the hero summary, latest-post links, and share controls, while the right column renders the MDX content via `BlogArticleLayout`.

## Open Questions

1- Do we need author multi-tenancy now, or wait until additional contributors join the Substack publication?

## Testing / Verification

- `pnpm sync:blog` creates new MDX files and updates meta indexes without stomping manual edits.
- `pnpm dev:www` renders `/blog` and `/blog/2025/...` without additional configuration.
- Lint + type checks (`pnpm lint`) remain clean after syncing.

